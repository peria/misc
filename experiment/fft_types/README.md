# FFT 実装系による速度差の測定

一口に FFT と言っても Stockham(Self-sorting) / Cooley-Tukey(in-place)、時間間引き(DIT)/周波数間引き(DIF)、など実装方法にはバリエーションがある。
ひとまずその大まかな時間差を計測するコード類を書いているつもりである。

実験内容としては n 個の複素数に FFT と逆 FFT をかける作業を繰り返す。10^7 回、もしくは 2 秒を超えた時点で止めて FLOPS 計算している。FLOPS 算出が正しいのかは少し疑問だが、とりあえずルーチン同士の比較にはなると思う。

| #    |       PMP |    Cooley |  StockDIT |  StockDIF |
|------|----------:|----------:|----------:|----------:|
| 2^ 2 |  1556.064 |  1622.912 |  1725.888 |  1780.105 |
| 2^ 3 |  2670.906 |  2105.263 |  1584.906 |  1598.478 |
| 2^ 4 |  4127.466 |  4625.850 |  4949.955 |  4818.423 |
| 2^ 5 |  5355.781 |  4888.883 |  4952.172 |  4951.494 |
| 2^ 6 |  6848.182 |  6892.194 |  6740.349 |  6798.165 |
| 2^ 7 |  6184.517 |  6412.560 |  6340.868 |  6126.236 |
| 2^ 8 |  7367.544 |  7402.160 |  7152.408 |  7100.036 |
| 2^ 9 |  6620.590 |  6495.363 |  6487.714 |  5970.733 |
| 2^10 |  7288.599 |  7448.056 |  7156.951 |  7009.636 |
| 2^11 |  6606.540 |  6781.247 |  6493.805 |  5933.683 |
| 2^12 |  6686.343 |  6954.775 |  5834.674 |  5784.330 |
| 2^13 |  6493.536 |  6618.145 |  5562.229 |  5196.653 |
| 2^14 |  6758.621 |  6899.974 |  6047.957 |  5973.869 |
| 2^15 |  6315.737 |  6313.722 |  6424.560 |  6090.031 |
| 2^16 |  6635.651 |  6778.257 |  6617.825 |  5841.019 |
| 2^17 |  4793.752 |  5089.602 |  4321.444 |  4995.401 |
| 2^18 |  5311.658 |  5375.715 |  4300.861 |  3994.824 |
| 2^19 |  4138.196 |  3860.999 |  3722.914 |  3580.625 |
| 2^20 |  4384.110 |  4311.272 |  3686.279 |  3561.597 |
| 2^21 |  3916.048 |  3942.975 |  3375.455 |  3264.553 |
| 2^22 |  4241.732 |  4243.819 |  3604.480 |  3465.397 |
| 2^23 |  3866.371 |  3938.604 |  3436.774 |  3196.457 |

`PMP` は独自多倍長計算の中で使っている FFT から流用したもの。畳み込みへの応用しか想定しないので out-of-order の in-place FFT である。
`Cooley-Tukey` は in-order の in-place FFT である。in-order なので順変換と逆変換でルーチンの共有ができるためメンテナンスコストを大きく下げる。
`Stockham-DIX` は self-sorting FFT である。DIT (時間間引き) と DIF (周波数間引き) で作ってみた。こちらも順変換と逆変換でルーチン共有が可能だ。


速度比較としてはザックリ `Stockham` ＜ `PMP` ≦ `Cooley-Tukey` という感じである。Stockham はデータと同サイズの作業領域が必要なためキャッシュアウトにより速度低下するのが Cooley-Tukey より 1 段階早い (n=2^18 と 2^19)。
面白い比較なのが PMP と Cooley-Tukey で、並べ替えをしても計測誤差程度の差しか出てきていない。
