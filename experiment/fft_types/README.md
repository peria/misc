# FFT 実装系による速度差の測定

一口に FFT と言っても Stockham(Self-sorting) / Cooley-Tukey(in-place)、時間間引き(DIT)/周波数間引き(DIF)、など実装方法にはバリエーションがある。
ひとまずその大まかな時間差を計測するコード類を書いているつもりである。

ざっと計測した結果(暫定)がこちら。n 個の複素数を 1000 回 FFT と逆 FFT を繰り返すのに要した時間(秒)である。
1回きりの実験なので計測のブレはあるとは思うが、現状ではざっくり Stockham < CT DIT-DIF << DT DIF-DIT。

CooleyTukey DIT-DIF とは、CooleyTukey だと入出力のデータ並びが正順とビット逆順になることはよく知られていると思う。
今回は計算の応用先が畳み込み乗算という前提で計算するので、FFT 後のデータ順がビット逆順でも特に問題ない。
となると逆変換はビット逆順を入力とするアルゴリズムになる。テーブル保持した場合の w の利用順が同じになる組み合わせでやっているので FFT が DIT なら逆 FFT は DIF となる。
これを DIT-DIF と書いている。

| n  |Stockham DIT|Stockham DIF|CooleyTukey DIT-DIF|CooleyTukey DIF-DIT|
|----|----------:|----------:|----------:|----------:|
|2^ 8|      0.000|      0.000|      0.000|      0.000|
|2^ 9|      0.001|      0.001|      0.002|      0.001|
|2^10|      0.002|      0.002|      0.003|      0.002|
|2^11|      0.003|      0.003|      0.004|      0.002|
|2^12|      0.004|      0.003|      0.004|      0.003|
|2^13|      0.005|      0.004|      0.006|      0.006|
|2^14|      0.009|      0.009|      0.014|      0.014|
|2^15|      0.021|      0.021|      0.030|      0.035|
|2^16|      0.044|      0.044|      0.093|      0.083|
|2^17|      0.118|      0.115|      0.136|      0.173|
|2^18|      0.348|      0.482|      0.379|      0.646|
|2^19|      0.739|      0.658|      0.779|      1.846|
|2^20|      1.408|      1.598|      2.382|      3.901|
|2^21|      2.808|      2.903|      3.314|      8.398|
|2^22|      5.686|      5.851|      6.953|     18.288|
|2^23|     12.331|     12.686|     14.590|     40.453|

w のテーブルを用意したバージョンはこちら。ただしその初期化コストは計測時間に含めていない。
また CooleyTukey DIF-DIT はメモリアクセスが不連続だったのを連続アクセスに変更。
w のテーブルを最内ループで舐めることになるが結果的に高速だったので。

| n  |Stockham DIT|Stockham DIF|CooleyTukey DIT-DIF|CooleyTukey DIF-DIT|
|----|----------:|----------:|----------:|----------:|
|2^ 9|      0.000|      0.000|      0.000|      0.000|
|2^10|      0.001|      0.001|      0.003|      0.001|
|2^11|      0.002|      0.002|      0.003|      0.002|
|2^12|      0.002|      0.003|      0.003|      0.001|
|2^13|      0.004|      0.003|      0.003|      0.002|
|2^14|      0.005|      0.004|      0.004|      0.004|
|2^15|      0.009|      0.010|      0.010|      0.010|
|2^16|      0.020|      0.027|      0.023|      0.026|
|2^17|      0.076|      0.069|      0.049|      0.046|
|2^18|      0.189|      0.206|      0.136|      0.293|
|2^19|      0.674|      0.631|      0.355|      0.372|
|2^20|      1.009|      0.987|      0.945|      0.851|
|2^21|      3.037|      3.014|      2.353|      2.087|
|2^22|      4.772|      4.911|      5.072|      4.216|
|2^23|     10.786|     11.743|      8.504|      8.624|
